Disjoint Set Union によって $O(Q\alpha(HW))$ で処理可能